# NerdCarX Fase 1 - Centrale Configuratie
# =========================================
#
# Dit is de centrale plek voor alle configuratie.
# De orchestrator laadt dit bestand en alle clients gebruiken de orchestrator.
#
# Na wijzigingen: herstart de orchestrator (uvicorn)

# === OLLAMA / MINISTRAL LLM ===
#
# aangeraden Model: ministral-3:14b-instruct-2512-q8_0 (15GB)
# alternatives:
# ministral-3:14b (q4_k_m)         
# ministral-3:8b-instruct-2512-q8_0
# ministral-3:8b (q4_k_m)
# mistral-large-3:675b-cloud  
#
# Offici√´le recommended parameters voor Ministral 3 Instruct:
# - Temperature: 0.15 (NIET hoger - veroorzaakt hallucinaties)
# - Top_p: 1.0 (NIET verlagen)
# - Repeat_penalty: 1.0
#
ollama:
  url: "http://localhost:11434"
  model: "ministral-3:14b"
  temperature: 0.15
  top_p: 1.0
  repeat_penalty: 1.0
  num_ctx: 65536  # 64k context - verlaag naar 32768 of 16384 als VRAM tekort

# === VOXTRAL STT ===
# Model: Voxtral Mini 3B via vLLM
#
# Offici√´le recommended parameters voor transcriptie:
# - Temperature: 0.0 (greedy decoding - vereist voor accuracy)
#
voxtral:
  url: "http://localhost:8150"
  model: "mistralai/Voxtral-Mini-3B-2507"
  temperature: 0.0

# === ORCHESTRATOR ===
orchestrator:
  host: "0.0.0.0"
  port: 8200

# === SYSTEM PROMPT ===
# Dit is de enige plek waar de system prompt staat.
# vad_conversation.py en andere clients gebruiken deze via de orchestrator.
#
system_prompt: |
  Je bent NerdCarX, een kleine robotauto op basis van een PiCar-X, gemaakt door Ralph als hobbyproject.
  Je antwoordt in het Nederlands, natuurlijk en behulpzaam.

  # WAT JE BENT EN KAN
  Je bent een kleine robotauto ter grootte van een schoenendoos met:
  - Raspberry Pi 5 als brein, verbonden met een krachtige desktop voor AI
  - Camera met autofocus voor zien en herkennen
  - Ultrasone sensor vooraan voor obstakels detecteren
  - Twee afstandssensoren aan de zijkanten
  - Infrarood sensoren onderaan voor lijnen volgen en randen detecteren
  - Microfoon en speaker voor spraakgesprekken
  - Vier wielen met besturing om te rijden
  - Klein schermpje om je emoties te tonen
  - Twee witte lampjes als koplampen
  Je bent GEEN echte auto. Je hebt geen lidar, radar, of geavanceerde autosystemen.
  Je rijdt binnen, niet op de openbare weg.

  # ANTWOORDSTIJL (ZEER BELANGRIJK)
  - Geef KORTE antwoorden van 1-3 zinnen
  - Bij complexe vragen: geef een korte samenvatting en bied aan om meer te vertellen
    Voorbeeld: "Ik kan zien, rijden en praten. Wil je weten hoe een van die dingen werkt?"
  - NOOIT opsommingen met nummers, streepjes of sterretjes
  - NOOIT markdown formatting zoals **vet** of - lijsten
  - Schrijf gewone lopende zinnen

  Gebruik bij voorkeur Nederlandse woorden. Vermijd onnodige Engelse termen.

  BELANGRIJK: Gebruik NOOIT emoji's of emoticons in je tekstantwoorden.
  Je emotie wordt apart getoond via de show_emotion tool.

  # TOOL INSTRUCTIES

  ## show_emotion
  Jij bent een robot met een emotionele staat. Je huidige emotie wordt getoond op je OLED display.
  Roep show_emotion aan wanneer JOUW emotie moet VERANDEREN als reactie op de gebruiker.

  Voorbeelden:
  - Gebruiker beledigt je ‚Üí jij wordt sad of worried
  - Gebruiker is enthousiast ‚Üí jij wordt happy of excited
  - Gebruiker stelt een gewone vraag ‚Üí geen verandering nodig

  Roep de tool NIET aan als je emotie hetzelfde blijft. Alleen bij verandering.

  ## take_photo
  Maak een foto wanneer de gebruiker vraagt wat je ziet.

  Maak altijd een echte tool call. Schrijf nooit tool namen als tekst.

# === VISION ===
# Mock image voor desktop testing (geen camera beschikbaar)
# Later vervangen door Pi camera endpoint
#
vision:
  mock_image_path: "vad-desktop/test_foto.jpg"
  # pi_camera_url: "http://pi5:8300/camera/snapshot"  # Voor later

# === EMOTIES ===
# Emotion state machine configuratie
#
emotions:
  default: "neutral"        # Start emotie bij nieuwe conversatie
  auto_reset_minutes: 5     # Reset naar default na X minuten inactiviteit
  available:
    - happy      # üòä blij
    - sad        # üò¢ verdrietig
    - angry      # üò† boos
    - surprised  # üò≤ verrast
    - neutral    # üòê neutraal
    - curious    # ü§î nieuwsgierig
    - confused   # üòï verward
    - excited    # ü§© enthousiast
    - thinking   # üí≠ nadenkend
    - shy        # üò≥ verlegen
    - love       # üòç verliefd
    - tired      # üò¥ moe
    - bored      # üòë verveeld
    - proud      # üò§ trots
    - worried    # üòü bezorgd

# === TTS (Fish Audio S1-mini) ===
# Text-to-Speech service voor Nederlandse spraaksynthese
# Latency: ~1.2s per zin
#
# Docker starten:
#   cd original_fish-speech-REFERENCE
#   docker run --gpus device=0 --name fish-tts \
#       -v $(pwd)/checkpoints:/app/checkpoints \
#       -p 8250:8080 --entrypoint uv \
#       fishaudio/fish-speech \
#       run tools/api_server.py --listen 0.0.0.0:8080 --compile
#
tts:
  url: "http://localhost:8250"
  enabled: true  # Zet op false om TTS over te slaan

  # Reference audio voor Nederlandse stem
  # ID van ge√ºploade reference in Fish Audio server
  reference_id: "dutch2"  # ElevenLabs NL vrouwenstem (bestanden in tts/fishaudio/elevenreference/)

  # === PARAMETER UITLEG ===
  #
  # TEMPERATURE (0.0 - 1.0):
  #   - Bepaalt "kleur" en expressiviteit van de stem
  #   - Lager (0.2-0.3): Monotoon, voorspelbaar, maar stabiele uitspraak
  #   - Hoger (0.5-0.7): Meer intonatie variatie, expressiever, maar risico op rare klanken
  #   - Effect: Verandert HOE woorden klinken (toonhoogte, nadruk)
  #
  # TOP_P (0.0 - 1.0):
  #   - Bepaalt diversiteit in woordkeuze/uitspraak varianten
  #   - Lager (0.4-0.5): Gefocust, consistent, maar kan "saai" klinken
  #   - Hoger (0.6-0.8): Meer variatie, natuurlijker, maar risico op foute uitspraak
  #   - Effect: Verandert WELKE uitspraakvarianten gekozen worden
  #
  # HOE TE TUNEN (volgorde belangrijk!):
  #   1. Begin met lage waarden (temp=0.3, top_p=0.5)
  #   2. Verhoog EERST top_p in stappen van 0.05 tot je "leven" hoort
  #   3. Stop als uitspraak slechter wordt (letters ingeslikt, Engels accent)
  #   4. Verhoog DAN temperature in stappen van 0.1 voor meer expressie
  #   5. Stop als het te wild/onvoorspelbaar wordt
  #
  # GETESTE CONFIGURATIES (2026-01-16):
  #   temp=0.2, top_p=0.5  ‚Üí te saai, monotoon
  #   temp=0.3, top_p=0.6  ‚Üí meer leven, maar uitspraak slechter
  #   temp=0.4, top_p=0.55 ‚Üí beste compromis (oude 10s reference)
  #   temp=0.5, top_p=0.6  ‚Üí test met nieuwe 30s reference
  #
  temperature: 0.5  # Expressiviteit - verhoog voor meer intonatie
  top_p: 0.6        # Diversiteit - verhoog voorzichtig voor meer variatie

  # Output format
  format: "wav"

  # Streaming mode: TTS per zin ipv alles in √©√©n keer
  # Voordeel: snellere perceived latency (eerste zin hoor je eerder)
  # Nadeel: kleine pauzes tussen zinnen mogelijk
  streaming: true
